% arara: xelatex
\documentclass[12pt]{article}

% \usepackage{physics}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }

\usepackage{tikzducks}

\usepackage{tikz} % картинки в tikz
\usetikzlibrary{shapes, arrows, positioning}
\usepackage{microtype} % свешивание пунктуации

\usepackage{array} % для столбцов фиксированной ширины

\usepackage{indentfirst} % отступ в первом параграфе

\usepackage{sectsty} % для центрирования названий частей
\allsectionsfont{\centering}

\usepackage{amsmath, amsfonts, amssymb} % куча стандартных математических плюшек

\usepackage{comment}

\usepackage[top=2cm, left=1.2cm, right=1.2cm, bottom=2cm]{geometry} % размер текста на странице

\usepackage{lastpage} % чтобы узнать номер последней страницы

\usepackage{enumitem} % дополнительные плюшки для списков
%  например \begin{enumerate}[resume] позволяет продолжить нумерацию в новом списке
\usepackage{caption}

\usepackage{url} % to use \url{link to web}


\newcommand{\smallduck}{\begin{tikzpicture}[scale=0.3]
    \duck[
        cape=black,
        hat=black,
        mask=black
    ]
    \end{tikzpicture}}

\usepackage{fancyhdr} % весёлые колонтитулы
\pagestyle{fancy}
\lhead{Time Series and Stochastic Processes}
\chead{}
\rhead{Home assignments for samurai}
\lfoot{}
\cfoot{}
\rfoot{}

\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\usepackage{tcolorbox} % рамочки!

\usepackage{todonotes} % для вставки в документ заметок о том, что осталось сделать
% \todo{Здесь надо коэффициенты исправить}
% \missingfigure{Здесь будет Последний день Помпеи}
% \listoftodos - печатает все поставленные \todo'шки


% более красивые таблицы
\usepackage{booktabs}
% заповеди из докупентации:
% 1. Не используйте вертикальные линни
% 2. Не используйте двойные линии
% 3. Единицы измерения - в шапку таблицы
% 4. Не сокращайте .1 вместо 0.1
% 5. Повторяющееся значение повторяйте, а не говорите "то же"


\setcounter{MaxMatrixCols}{20}
% by crazy default pmatrix supports only 10 cols :)


\usepackage{fontspec}
\usepackage{libertine}
\usepackage{polyglossia}

\setmainlanguage{russian}
\setotherlanguages{english}

% download "Linux Libertine" fonts:
% http://www.linuxlibertine.org/index.php?id=91&L=1
% \setmainfont{Linux Libertine O} % or Helvetica, Arial, Cambria
% why do we need \newfontfamily:
% http://tex.stackexchange.com/questions/91507/
% \newfontfamily{\cyrillicfonttt}{Linux Libertine O}

\AddEnumerateCounter{\asbuk}{\russian@alph}{щ} % для списков с русскими буквами
% \setlist[enumerate, 2]{label=\asbuk*),ref=\asbuk*}

%% эконометрические сокращения
\DeclareMathOperator{\Cov}{\mathbb{C}ov}
\DeclareMathOperator{\Corr}{\mathbb{C}orr}
\DeclareMathOperator{\Var}{\mathbb{V}ar}
\DeclareMathOperator{\col}{col}
\DeclareMathOperator{\row}{row}

\let\P\relax
\DeclareMathOperator{\P}{\mathbb{P}}

\DeclareMathOperator{\E}{\mathbb{E}}
% \DeclareMathOperator{\tr}{trace}
\DeclareMathOperator{\card}{card}

\DeclareMathOperator{\Convex}{Convex}

\newcommand \cN{\mathcal{N}}
\newcommand \RR{\mathbb{R}}
\newcommand \NN{\mathbb{N}}
\newcommand{\hb}{\hat{\beta}}





\begin{document}

Be brave! You can use python. In this case just provide the code. 
You can use ChatGPT or any other LLM. In this case just provide the full prompt. 
Don't panic!


\section*{Home assignment 1}


Deadline: 2024-09-23, 21:00.

\begin{enumerate}
\item The Cat can be only in two states: Sleeping ($S$) and Eating ($E$). 
Cat's mood depends only on the previous state. 
The transition probabilities are given below:

%\begin{minipage}
\begin{tikzpicture}[->,>= stealth', shorten >=2pt , line width=0.5pt, node distance=2cm]
    \node [circle, draw] (one) {$E$};
    \node [circle, draw] (two) [right of=one] {$S$};
    \path (one) edge [bend left] node [above] {$0.1$} (two);
    \path (two) edge [bend left] node [below]{$0.2$} (one);
    \path (two) edge [loop right] node {} (two);
    \path (one) edge [loop left] node {} (one);
\end{tikzpicture}
%\end{minipage}


\begin{enumerate}
    \item Compute the missing probabilities on the graph.
    \item Write down the transition matrix.
    \item Compute $\P(X_3 = \text{Eating} \mid X_0 = \text{Eating})$.
\end{enumerate}

\item Cowboy Joe enters the Epsilon Bar and orders one pint of beer. 
He drinks it and orders one pint more. 
And so on and so on and so on\dots{ }
The problem is that the barmaid waters down each pint with probability $0.2$ independently of other pints.
Joe does not like watered down beer. 
He will blow the Epsilon Bar to hell if two or more out of the last three pints are watered down. 

We point out that Joe never drinks less than 3 pints in a bar. 

\begin{enumerate}
    \item What is the expected number of pints of beer Joe will drink?
\end{enumerate}

Let $Y_t$ be the indicator that the pint number $t$ was watered down. 
Consider the Markov chain $S_t = (y_{t-2}, y_{t-1}, y_t)$.
For example, $S_t = (100)$ means that the pint number $t-2$ was watered down while pints number $t-1$ and $t$ are good. 

\begin{enumerate}[resume]
\item What are the possible values of $S_3$ and their probabilities?
\item Write down the transition matrix of this Markov chain.
\end{enumerate}

Note: questions (2b) and (2c) were updated!

\item Pavel Durov starts at the point $X_0 = 3$ on the real line. 
Each minute he moves left with probability $0.4$ or right with probability $0.6$ independently of past moves.
The points $0$ and $5$ are absorbing. 
If Pavel reaches $0$ or $5$ he stays there forever.
Let $X_t$ be the coordinate of Pavel after $t$ minutes. 

\begin{enumerate}
    \item Write down the transition matrix of this Markov chain. 
    \item Calculate the distribution of $X_7$ [list all values of the random variable $X_7$ and estimate the probabilities].
\end{enumerate}



Hint: you are free to use python for this problem :)


\end{enumerate}


\section*{Home assignment 2}

Deadline: 2024-09-27, 21:00.

\begin{enumerate}
    \item {[10 points]} Consider two identical hedgehogs starting at the vertices $A$ and $B$ of a polygon $ABCD$. 
    Each minute each hedehog simulteneously and independently chooses to go clockwise to the adjacent point, to go counter-clockwise to the adjacent point or to stay at his location.
    
    Thus the brotherhood of two brave hedgehogs can be in three states: in one vertex, 
    in two adjacent vertices, in two non-adjacent vertices.

  
    \begin{enumerate}
      \item Draw the graph for the brotherhood Markov chain and calculate all transition probabilities. 
      \item Write down the transition matrix of the brotherhood Markov chain. 
      \item What is the probability that they will be in one vertex after 3 steps?
    \end{enumerate}
    
    \item {[10 points]} Consider the following Markov chain:

    \begin{tikzpicture}[->,>= stealth', shorten >=2pt , line width=0.5pt, node distance=2cm]
        \node [circle, draw] (one) {$A$};
        \node [circle, draw] (two) [right of=one] {$B$};
        \node [circle,  draw] (three) [right of=two] {$C$};
        \path (one) edge [bend left] node [above] {$0.3$} (two);
        \path (two) edge [bend right] node [below] {$0.3$} (three);
        \path (two) edge [bend left] node [below]{$0.7$} (one);
        \path (three) edge [loop right] node {$0.2$} (three);
        \path (three) edge [bend right] node [above] {$0.8$} (two);
        \path (one) edge [loop left] node {$0.7$} (one);
    \end{tikzpicture}

    \begin{enumerate}
        \item Find the stationary distribution of this Markov chain.
    \end{enumerate}
    
    The Markov chains starts at the vertex $A$.
    Let $N$ be the first moment when the state $C$ will be reached.

    \begin{enumerate}[resume]
      \item Find the expected value $\E(N)$.
      \item Find the variance $\Var(N)$. 
    \end{enumerate}

    \item {[10 points]} Bonnie and Clyde start at the points $(5, 0)$ and $(-5, 0)$ of the plane. 
    Each minute each of them simulteneously and independently makes one step in one of the four possible directions (south, north, east, west).

    Each of them does $n$ steps.
    Let $X$ be the number of times they will be at the same point.
    \begin{enumerate}
        \item Estimate the probability $\P(X \geq 1)$ for $n=50$ using $B=10000$ simulations. 
        \item Estimate $\E(X)$ and $\Var(X)$ for $n=50$ using $B=10000$ simulations. 
        \item Plot the estimated value of $\E(X)$ as a function of $n$ for $n$ from $1$ to $200$ using $B=10000$ simulations. 
    \end{enumerate}

\end{enumerate}


\end{document}


% здесь проектируемая часть

\item {[10 points]} Design a Markov chain with 3 states such that the stationary distribution is $p = (0.1, 0.2, 0.7)$.
In your Markov chain it should be possible to reach every state from every state in one or two steps. 


\end{document}

